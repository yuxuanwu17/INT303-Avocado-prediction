### Import the libraries
```{rï¼Œinclude=False}
library(tidyr)
library(skimr)
library(GGally)
library(viridis)
library(caret)
library(e1071)
library(rpart)
library(xgboost)
library(corrplot)
library(corrgram)
library(ggplot2)
library(ggthemes)
library(psych)
library(scales)
library(treemap)
library(repr)
library(cowplot)
library(magrittr)
library(ggpubr)
library(RColorBrewer)
library(plotrix)
library(ggrepel)
library(tidyverse)
library(gridExtra)
library(lubridate)
library(tibbletime)
library(reshape2)
```
### Load the data and return the head of data
```{r}
df <- read.csv("/Users/yuxuan/Desktop/INT301-Avocado-prediction/avocado-updated-2020.csv")
head(df)
```
### Explore the data and some clarification

#### Explain the features
- date \- The date of the observation
- average_price \- The average price of a single
- total_volume \- Total number of avocados sold
- year \- The year
- type \- conventional or organic
- geography \- The city or region of the observation

#### X4046, X4225, X4770 stands for the PLU code

- Small/Medium Hass Avocado (~3-5oz avocado) | #4046 <br>
- Large Hass Avocado (~8-10oz avocado) | #4225 <br>
- Extra Large Hass Avocado (~10-15oz avocado) | #4770 <br>

### Exploratory Data Analysis

#### Density plot of the difference between two avocadoes.
```{r}
levels(df$type)
```
```{r}
options(repr.plot.width = 8, repr.plot.height = 4)
ggplot(df, aes(x=average_price, fill=type))+
  geom_density()+
  facet_wrap(~type)+
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5),legend.position = "bottom")+
  labs(title = "Avocado Price by type")+
  scale_fill_brewer(palette = "Set2")
```
### Create a matrix to demonstrate the volume of conventional and organic avocadoes
```{r}
vol_type <- df %>% group_by(type) %>% summarise(average_volume = round(mean(total_volume),3),average_price = round(mean(average_price),3)) %>% mutate(volume_percent= round(prop.table(average_volume)*100,3))
vol_type
```
*As can be seen from the density plot and the table in avocadoes.*
- there are two types of avocado: organic and conventional
- organic avocado share a small percent (3.2%) of volume but has a high price (1.62)
- conventional avocado share a large percent (96.8) of volume but has a relative low price (1.16)

### Avocado price with the Date

```{r}
## Change the Date column from factor to the date format
df$date <- as.Date(df$date, "%Y-%m-%d")

## Sort the dates and order the datesets in date
df <- df[order(df$date),]

## Make the plot
df %>% select(date, average_price, type) %>%
  ggplot(aes(x=date,y=average_price))+
  geom_area(aes(color=type,fill=type),alpha=0.3,position=position_dodge(0.8))+
  theme_minimal()+
  scale_color_manual(values = c("#ED7921","#62BE51"))+
  scale_fill_manual(values = c("#FD833E","#B8FC5F")
)

```



















